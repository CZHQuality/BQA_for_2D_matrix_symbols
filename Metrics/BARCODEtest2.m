%%
%fix the labels
%used for SSIM
clear;clc;
%{
A=[%4 0 1 2 0 1 4 1 4 1 3 2 2 4 2 0 3 2 3 3 0 2 2 3 3 2 4 3 4 0 2 2 4 2 4 1 ...
    %4 1 3 3 2 0 4 1 1 2 0 1 3 1 3 4 4 2 0 4 2 3 4 1 3 2 3 2 2 2 1 1 3 2 0 3 ...
    %2 4 2 4 4 0 3 1 4 1 2 1 2 0 4 2 4 0 0 3 0 2 3 0 3 4 0 0 ...
    %0 2 2 2 2 2 4 3 2 2 1 2 2 0 3 3 2 4 2 4 0 2 4 2 3 0 3 3 2 3 3 2 0 2 3 2 3 ...
 %0 2 0 4 0 4 1 4 2 1 1 1 2 0 0 4 3 3 1 1 1 2 2 3 0 0 0 2 2 2 3 2 3 1 0 3 3 ...
 %0 2 3 3 0 1 3 3 4 3 1 0 0 1 4 4 3 2 2 4 4 3 2 3 2 1 ];
 2 3 2 3 3 3 0 3 2 2 4 3 4 3 1 1 3 2 4 4 3 3 3 3 2 3 2 4 4 2 3 2 1 0 1 3 0 ...
 1 1 3 1 0 4 1 4 4 4 2 2 0 3 3 4 2 0 1 2 2 2 3 4 4 1 2 3 0 3 1 2 1 4 4 0 0 ...
 4 4 1 2 3 4 2 4 4 3 2 2 4 2 2 1 4 4 1 2 2 4 2 2 3 4];

B=[%4 0 4 2 0 1 4 2 4 1 3 4 4 0 2 0 3 3 3 3 0 3 2 3 3 1 4 3 1 0 2 2 4 2 0 ...
    %2 2 0 3 3 2 1 1 4 1 4 0 1 3 1 2 1 4 2 4 4 3 2 1 0 2 2 3 1 0 2 1 1 3 3 ...
    %0 3 2 0 1 2 1 0 4 1 4 1 2 4 2 4 4 3 1 0 4 3 1 2 3 4 3 1 0 0 ...
    %1 1 4 1 2 4 0 3 1 1 1 1 2 0 3 2 2 0 2 4 0 2 4 0 3 1 3 1 1 3 3 1 0 1 3 1 3 ...
 %0 4 4 4 4 2 4 2 1 0 0 1 2 1 0 0 3 3 0 0 4 2 3 0 0 0 0 2 2 4 3 2 3 0 0 3 4 ...
 %4 2 3 3 0 1 2 3 1 4 2 0 0 4 1 1 3 2 2 4 4 3 2 2 2 1 ];
 0 2 3 2 1 3 0 3 4 3 0 2 0 3 0 2 3 2 4 2 3 2 3 3 2 2 2 1 0 1 1 3 0 1 1 3 0 ...
 4 2 3 1 1 4 1 4 1 1 2 2 4 1 3 4 4 4 0 2 4 1 3 4 4 0 1 3 1 3 0 4 1 0 1 4 1 ...
 3 4 4 4 3 1 2 0 4 3 4 2 4 3 2 4 4 4 2 1 3 1 4 2 3 0];
%}
%A=[[0.820035684881773,0.803053966157246,0.767307237019734,0.689256801201608,0.651339776576808,0.848216015671125,0.797168677700865,0.755032588701741,0.690840585481554,0.657863481235238,0.844376391353575,0.794657403608573,0.756890743474765,0.669844646815051,0.642280217412781,0.752854818667955,0.792382032144255,0.758462134182425,0.705205043717284,0.680091483155502,0.834727348496744,0.750056094649313,0.766697235170920,0.696640331178188,0.672832891239592,0.855204558063878,0.829179072679529,0.798069606337918,0.720424286283740,0.696458520196346,0.876805040505037,0.862921370724028,0.807555841120988,0.727036239342968,0.688217601753505,0.770754473913320,0.772091607189988,0.744784935748575,0.681437237788611,0.653787426571326,0.862238674417221,0.795393306493196,0.772171869924375,0.703188189859698,0.678097334832336,0.866704549731780,0.829326973898400,0.803518253689407,0.714402917125732,0.684086341437176,0.858234026738056,0.823726335834095,0.809170711689897,0.736994901979873,0.711035819316289,0.918537417871394,0.891752133001293,0.869329221419471,0.793431808541125,0.762411247157812,0.841196964881806,0.793992379525894,0.759171867162820,0.699438515837596,0.661412020778844,0.948124194838820,0.909838620371506,0.880417007713934,0.842242939822611,0.801657057526064,0.849172959693013,0.815553883840880,0.789426379616543,0.701883762313154,0.674176005701745,0.941268723297785,0.907789789281303,0.875890750129281,0.829721905660247,0.783671416688887,0.828839726807826,0.794925689409559,0.776736444903841,0.693462418453581,0.662815308480861,0.876259579214113,0.836203048601590,0.825135334848702,0.752900408557681,0.710328119789798,0.913096291904156,0.879788101029379,0.882619143616853,0.777963281527767,0.751204854086877,0.920370397067015,0.888193593681300,0.866643273397059,0.781553695679980,0.737182621867363,0.844562370062099,0.831068814199831,0.772703024802740,0.702833433243746,0.671626230497110,0.882868621268763,0.847043602061223,0.836688354116820,0.761045836301759,0.722414142348863,0.859466435431971,0.859704481367067,0.800877197717325,0.733376717182439,0.684919279723558,0.855621940628005,0.822462850657519,0.792782990279109,0.736482226767922,0.708224913561925,0.880831447130828,0.861171907963871,0.805024718987138,0.730652763772534,0.701399815224122,0.984442206694279,0.965386591998657,0.948096806029673,0.928673613223599,0.889980196644709,0.752975389873158,0.866060523110787,0.785399750882427,0.817051322379549,0.713789251841803,0.891719796909284,0.860406777138888,0.849720969883205,0.825009524634161,0.816166786971280,0.966060962205194,0.953522398679880,0.931232243081279,0.903605107146262,0.847669183377834,0.955696395248918,0.936704790243897,0.927178874856516,0.921024416541107,0.915748975989356]];
A=[[0.998791999881784,0.997308248063369,0.994269676549668,0.991812236339320,0.984784922478665,0.998692040400351,0.997522422321388,0.995824261835000,0.991968136998150,0.981388796375452,0.998675170584679,0.997378664736657,0.993091868253884,0.996181548274093,0.986038846030708,0.998832543430534,0.997386579879429,0.994914738598755,0.991720000663842,0.984979851350268,0.998691582659218,0.996545919331809,0.991226836316571,0.991303439449679,0.984444835246966,0.998690074488637,0.997361949800374,0.994532200294006,0.991348171076558,0.985561493535923,0.999001166101838,0.997956045242658,0.995627547151352,0.992045373827464,0.986012209285123,0.998776873425078,0.998853110202454,0.994629372028733,0.991373587062839,0.987101914017672,0.998530531745882,0.996965230989723,0.998641514693740,0.991584921714617,0.986099544263346,0.998560178297761,0.996876580167613,0.994383899255982,0.991689147614051,0.984316080641696,1.00035483193137,0.997629230705085,0.994339708066732,0.991423164313639,0.985706554991975,0.998503909476607,0.997253513698541,0.994067571640033,0.990432494738311,0.985088011859887,0.999062786126669,0.997843471573520,0.995782627021969,0.992797807966791,0.986968072964357,0.999015041315457,0.997498683897073,0.994768211522294,0.991773310714819,0.988139463083510,0.998995770086029,0.997370484147454,0.994638444606969,0.991611535264602,0.984717327146854,0.997563502808293,0.996013976721915,0.987373014404043,0.985871659166669,0.975374574709106,0.998815951675064,0.997556091055406,0.994610576331117,0.991947742384268,0.986682124299247,0.998618454847388,0.997006578055687,0.994275909431441,0.990945833433312,0.984865128179891,0.998621610373276,0.997057273393806,0.994131850496184,0.991266405733293,0.982832164764721,0.998701676173225,0.997122676193820,0.994054553621936,0.991256612684367,0.984635523114168,0.998793005140070,0.997758004488160,0.994663211084899,0.968824222169562,0.985882768819402,0.998591589543914,0.997053853434423,0.993961947725620,0.990916733178174,0.984301149226759,0.999031031320265,0.997793587654312,0.994990689663348,0.991229724637158,0.983458261745657,0.998720872308938,0.997423972244009,0.993934750696636,0.991257346365074,0.967558012730740,0.997425564353386,0.997883087664345,0.995337120019789,0.992294244644335,0.984888551719996,0.999062311537761,0.998025715935173,0.995863180107423,0.993661339795811,0.988383253002961,0.999945972815345,0.998026089077365,0.998738637948197,0.996237140787180,0.982615277384244,0.999550215170082,0.999128577313228,0.997048788991913,0.995803974577501,0.989954382009103,0.999889912465982,0.996433421042607,0.993141846100838,0.993848639298588,0.993929183100085,0.999558915150703,0.999146967021910,0.997300792336961,0.995321475296663,0.990475552067013]];
B=[4, 4, 4, 4, 0, 4, 4, 3, 4, 3, 4, 4, 3, 4, 3, 4, 4, 3, 4, 3, 4, 4, 4, 3, 3, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 4, 4, 4, 4, 3, 4, 4, 4, 4, 3, 4, 4, 3, 4, 3, 4, 3, 4, 3, 3, 4, 4, 4, 3, 0, 4, 4, 4, 4, 3, 4, 3, 3, 3, 0, 3, 4, 4, 4, 3, 3, 3, 3, 0, 0, 4, 4, 4, 4, 3, 4, 4, 4, 3, 3, 4, 3, 4, 3, 3, 4, 4, 4, 3, 3, 4, 4, 4, 3, 3, 4, 4, 4, 3, 0, 4, 4, 3, 3, 0, 4, 3, 3, 4, 0, 4, 4, 4, 3, 3, 3, 3, 3, 3, 0, 3, 3, 3, 3, 3, 3, 3, 3, 3, 0, 2, 3, 3, 3, 3, 3, 3, 3, 2, 2];
%{
for index = 1:100
    if(A(1,index)==4)
        A(1,index) = 0;
    else
        A(1,index) = A(1,index) + 1;
    end
end

for index = 1:100
    if(B(1,index)==4)
        B(1,index) = 0;
    else
        B(1,index) = B(1,index) + 1;
    end
end
%}
mos = B;
iqa = A;

%%
%logistic fitting

addpath('/home/chezhaohui/QA/Fitting/xiongkuo/');
[delta,beta,yhat,y,diff] = findrmse2(iqa,mos);
iqa = yhat';
beta
rmpath('/home/chezhaohui/QA/Fitting/xiongkuo/');

%%
%compute SRCC, PLCC and RMSE
addpath('/home/chezhaohui/QA/Fitting/');
[plcc,srocc,rmse] = verify_performance(mos, iqa, beta);
%beta = [10, 0, mean(iqa), 0.1, 0.1];[plcc,srocc,rmse] = verify_performance(mos, iqa, beta);
rmpath('/home/chezhaohui/QA/Fitting/');
